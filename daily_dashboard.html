<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Forage Kitchen - Daily Sales Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0f172a; color: #e2e8f0; min-height: 100vh; }

  .header { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); padding: 20px 30px; border-bottom: 1px solid #334155; display: flex; justify-content: space-between; align-items: center; }
  .header h1 { font-size: 24px; font-weight: 700; color: #f8fafc; }
  .header h1 span { color: #22c55e; }
  .header .meta { text-align: right; font-size: 13px; color: #94a3b8; }
  .header .meta .period { font-size: 16px; color: #f8fafc; font-weight: 600; }
  .header .meta .source { font-size: 11px; color: #f59e0b; text-transform: uppercase; letter-spacing: 1px; }

  .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

  /* KPI Cards */
  .kpi-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px; }
  .kpi-card { background: #1e293b; border-radius: 12px; padding: 20px; border: 1px solid #334155; }
  .kpi-card .label { font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: #94a3b8; margin-bottom: 8px; }
  .kpi-card .value { font-size: 28px; font-weight: 700; color: #f8fafc; }
  .kpi-card .sub { font-size: 13px; color: #94a3b8; margin-top: 4px; }
  .kpi-card .change { font-size: 14px; font-weight: 600; margin-top: 4px; }
  .kpi-card .change.positive { color: #22c55e; }
  .kpi-card .change.negative { color: #ef4444; }

  /* Section headers */
  .section-header { font-size: 18px; font-weight: 600; color: #f8fafc; margin: 24px 0 12px; padding-bottom: 8px; border-bottom: 1px solid #334155; }

  /* Charts row */
  .charts-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px; }
  .chart-card { background: #1e293b; border-radius: 12px; padding: 20px; border: 1px solid #334155; }
  .chart-card h3 { font-size: 14px; color: #94a3b8; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; }

  /* Store Table */
  .store-table { width: 100%; border-collapse: collapse; background: #1e293b; border-radius: 12px; overflow: hidden; border: 1px solid #334155; }
  .store-table th { background: #334155; padding: 12px 16px; text-align: left; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: #94a3b8; font-weight: 600; }
  .store-table th.right, .store-table td.right { text-align: right; }
  .store-table td { padding: 12px 16px; border-bottom: 1px solid #1e293b; font-size: 14px; }
  .store-table tr:nth-child(even) { background: #1e293b; }
  .store-table tr:nth-child(odd) { background: #172033; }
  .store-table tr:hover { background: #253352; }
  .store-table tr.total-row { background: #334155 !important; font-weight: 700; }
  .store-table tr.total-row td { border-top: 2px solid #4a5568; }
  .positive { color: #22c55e; }
  .negative { color: #ef4444; }
  .neutral { color: #94a3b8; }

  /* Daily detail table */
  .daily-table { width: 100%; border-collapse: collapse; background: #1e293b; border-radius: 12px; overflow: hidden; border: 1px solid #334155; margin-top: 16px; }
  .daily-table th { background: #334155; padding: 10px 12px; text-align: right; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; color: #94a3b8; }
  .daily-table th:first-child { text-align: left; }
  .daily-table td { padding: 8px 12px; text-align: right; font-size: 13px; border-bottom: 1px solid #253352; }
  .daily-table td:first-child { text-align: left; color: #94a3b8; }
  .daily-table tr:hover { background: #253352; }
  .daily-table .day-name { color: #f8fafc; font-weight: 500; }

  /* Tabs for store detail */
  .tab-bar { display: flex; gap: 4px; margin-bottom: 16px; flex-wrap: wrap; }
  .tab-btn { padding: 8px 16px; background: #1e293b; border: 1px solid #334155; border-radius: 8px; color: #94a3b8; cursor: pointer; font-size: 13px; font-weight: 500; transition: all 0.2s; }
  .tab-btn:hover { background: #253352; color: #f8fafc; }
  .tab-btn.active { background: #22c55e; color: #0f172a; border-color: #22c55e; font-weight: 700; }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  /* Refresh notice */
  .refresh-notice { text-align: center; padding: 12px; color: #64748b; font-size: 12px; margin-top: 20px; }

  @media (max-width: 768px) {
    .charts-row { grid-template-columns: 1fr; }
    .kpi-row { grid-template-columns: repeat(2, 1fr); }
    .header { flex-direction: column; gap: 10px; }
    .header .meta { text-align: left; }
  }
</style>
</head>
<body>

<div class="header">
  <h1>Forage <span>Kitchen</span> &mdash; Daily Sales</h1>
  <div class="meta">
    <div class="period" id="periodLabel"></div>
    <div id="dateRange"></div>
    <div id="lastUpdated"></div>
    <div class="source" id="dataSource"></div>
  </div>
</div>

<div class="container">
  <!-- KPI Cards -->
  <div class="kpi-row" id="kpiRow"></div>

  <!-- Charts -->
  <div class="charts-row">
    <div class="chart-card">
      <h3>Daily Net Sales (Current vs Prior Year)</h3>
      <canvas id="salesChart" height="200"></canvas>
    </div>
    <div class="chart-card">
      <h3>Daily Labor %</h3>
      <canvas id="laborChart" height="200"></canvas>
    </div>
  </div>

  <!-- Store Scoreboard -->
  <div class="section-header">Store Scoreboard &mdash; Period to Date</div>
  <table class="store-table" id="storeTable"></table>

  <!-- Daily Detail by Store -->
  <div class="section-header">Daily Detail</div>
  <div class="tab-bar" id="tabBar"></div>
  <div id="tabContents"></div>

  <div class="refresh-notice">
    To refresh data, run <code>python daily_dashboard.py</code> &bull; Data through <span id="dataThrough"></span> &bull; Generated <span id="refreshTime"></span>
  </div>
</div>

<script>
const D = {"generated": "2026-02-25T08:19:24.211397", "fiscal_year": 2026, "period": 3, "period_start": "2026-02-25", "period_end": "2026-03-31", "data_through": "2026-02-24", "today": "2026-02-25", "days_completed": 0, "stores": {"8001": {"name": "State Street", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 108283.35, "budget_cogs_pct": 30.7, "budget_payroll_pct": 30.1, "budget_crew_wages_pct": 20.9, "budget_sales_prorated": 0.0, "budget_variance": null}, "8002": {"name": "Hilldale", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 134746.5, "budget_cogs_pct": 30.9, "budget_payroll_pct": 27.2, "budget_crew_wages_pct": 19.4, "budget_sales_prorated": 0.0, "budget_variance": null}, "8003": {"name": "Monona", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 131597.94, "budget_cogs_pct": 30.7, "budget_payroll_pct": 27.4, "budget_crew_wages_pct": 19.5, "budget_sales_prorated": 0.0, "budget_variance": null}, "8004": {"name": "Old Sauk", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 126204.0, "budget_cogs_pct": 30.7, "budget_payroll_pct": 26.5, "budget_crew_wages_pct": 18.5, "budget_sales_prorated": 0.0, "budget_variance": null}, "8005": {"name": "Champaign", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 80358.3, "budget_cogs_pct": 30.7, "budget_payroll_pct": 36.9, "budget_crew_wages_pct": 25.9, "budget_sales_prorated": 0.0, "budget_variance": null}, "8006": {"name": "Whitefish Bay", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 108039.71, "budget_cogs_pct": 30.7, "budget_payroll_pct": 28.5, "budget_crew_wages_pct": 19.8, "budget_sales_prorated": 0.0, "budget_variance": null}, "8007": {"name": "Sun Prairie", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 133172.0, "budget_cogs_pct": 30.7, "budget_payroll_pct": 26.9, "budget_crew_wages_pct": 19.3, "budget_sales_prorated": 0.0, "budget_variance": null}, "8008": {"name": "Pewaukee", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 71750.4, "budget_cogs_pct": 30.7, "budget_payroll_pct": 41.0, "budget_crew_wages_pct": 27.5, "budget_sales_prorated": 0.0, "budget_variance": null}, "8009": {"name": "MKE Public Market", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 88269.4, "budget_cogs_pct": 30.7, "budget_payroll_pct": 32.0, "budget_crew_wages_pct": 22.1, "budget_sales_prorated": 0.0, "budget_variance": null}, "8010": {"name": "Brookfield", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "py_guests": 0, "daily": [], "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 0.0, "budget_cogs_pct": 0, "budget_payroll_pct": 0, "budget_crew_wages_pct": 0, "budget_sales_prorated": 0.0, "budget_variance": null}}, "all_stores": {"name": "All Stores", "net_sales": 0, "gross_sales": 0, "guests": 0, "checks": 0, "labor_cost": 0, "labor_hours": 0, "py_net_sales": 0, "labor_pct": 0, "avg_check": 0, "sss_growth": null, "budget_sales": 982421.6, "budget_cogs_pct": 30.7, "budget_payroll_pct": 29.8, "budget_crew_wages_pct": 20.9, "budget_sales_prorated": 0.0, "budget_variance": null, "daily": []}, "store_order": ["8001", "8002", "8003", "8004", "8005", "8006", "8007", "8008", "8009", "8010"], "has_budget": true, "data_source": "Toast POS"};

const dayNames = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
const fmt = (n) => n == null ? '—' : '$' + Number(n).toLocaleString('en-US', {minimumFractionDigits:0, maximumFractionDigits:0});
const fmtPct = (n) => n == null ? '—' : n.toFixed(1) + '%';
const fmtChange = (n) => {
  if (n == null) return '<span class="neutral">N/A</span>';
  const cls = n >= 0 ? 'positive' : 'negative';
  const sign = n >= 0 ? '+' : '';
  return `<span class="${cls}">${sign}${n.toFixed(1)}%</span>`;
};

// Header
document.getElementById('periodLabel').textContent = `FY${D.fiscal_year} Period ${D.period}`;
document.getElementById('dateRange').textContent = `${D.period_start} to ${D.period_end} (${D.days_completed} completed days)`;
document.getElementById('lastUpdated').textContent = `Updated: ${new Date(D.generated).toLocaleString()}`;
document.getElementById('refreshTime').textContent = new Date(D.generated).toLocaleString();
document.getElementById('dataThrough').textContent = D.data_through;
document.getElementById('dataSource').textContent = `Data source: ${D.data_source || 'Toast POS'}`;

// KPI Cards
const a = D.all_stores;
const kpis = [
  { label: 'Period Net Sales', value: fmt(a.net_sales), sub: 'Budget: ' + fmt(a.budget_sales_prorated) + ' (prorated)', change: a.budget_variance, changeLabel: 'vs Budget' },
  { label: 'SSS Growth', value: a.sss_growth != null ? (a.sss_growth >= 0 ? '+' : '') + a.sss_growth + '%' : 'N/A', sub: 'Same store sales YoY (' + D.days_completed + ' days)', change: null, highlight: a.sss_growth },
  { label: 'Labor %', value: fmtPct(a.labor_pct), sub: 'Bgt Crew Wages: ' + fmtPct(a.budget_crew_wages_pct), change: a.budget_crew_wages_pct > 0 ? -(a.labor_pct - a.budget_crew_wages_pct) : null, changeLabel: 'vs Budget' },
  { label: 'Avg Check', value: fmt(a.avg_check), sub: a.checks.toLocaleString() + ' checks', change: null },
  { label: 'Guest Count', value: a.guests.toLocaleString(), sub: 'Period to date', change: null },
  { label: 'Full Period Budget', value: fmt(a.budget_sales), sub: 'Pace: ' + (a.budget_sales > 0 ? (a.net_sales / a.budget_sales_prorated * 100).toFixed(0) + '% of prorated' : 'N/A'), change: null, highlight: a.budget_variance },
];

const kpiRow = document.getElementById('kpiRow');
kpis.forEach(k => {
  const card = document.createElement('div');
  card.className = 'kpi-card';
  let changeHtml = '';
  if (k.change != null) {
    const cls = k.change >= 0 ? 'positive' : 'negative';
    const sign = k.change >= 0 ? '+' : '';
    changeHtml = `<div class="change ${cls}">${sign}${k.change.toFixed(1)}% ${k.changeLabel || ''}</div>`;
  }
  let valueColor = '';
  if (k.highlight != null) {
    valueColor = k.highlight >= 0 ? 'color:#22c55e' : 'color:#ef4444';
  }
  card.innerHTML = `<div class="label">${k.label}</div><div class="value" style="${valueColor}">${k.value}</div><div class="sub">${k.sub}</div>${changeHtml}`;
  kpiRow.appendChild(card);
});

// Sales Chart
const dailyData = a.daily || [];
const labels = dailyData.map(d => {
  const dt = new Date(d.date + 'T12:00:00');
  return dayNames[dt.getDay()] + ' ' + (dt.getMonth()+1) + '/' + dt.getDate();
});

new Chart(document.getElementById('salesChart'), {
  type: 'bar',
  data: {
    labels: labels,
    datasets: [
      { label: 'Current Year', data: dailyData.map(d => d.net_sales), backgroundColor: '#22c55e88', borderColor: '#22c55e', borderWidth: 1 },
      { label: 'Prior Year', data: dailyData.map(d => d.py_net_sales), backgroundColor: '#64748b44', borderColor: '#64748b', borderWidth: 1 },
    ]
  },
  options: {
    responsive: true,
    plugins: { legend: { labels: { color: '#94a3b8' } } },
    scales: {
      x: { ticks: { color: '#64748b', font: { size: 10 } }, grid: { color: '#1e293b' } },
      y: { ticks: { color: '#64748b', callback: v => '$' + (v/1000).toFixed(0) + 'k' }, grid: { color: '#1e293b44' } }
    }
  }
});

// Labor Chart - with budget crew wages % reference line
const budgetCrewPct = a.budget_crew_wages_pct || 0;
const budgetCrewLine = budgetCrewPct > 0 ? dailyData.map(() => budgetCrewPct) : [];
const laborDatasets = [
  { label: 'Labor %', data: dailyData.map(d => d.labor_pct), borderColor: '#f59e0b', backgroundColor: '#f59e0b22', fill: true, tension: 0.3, pointRadius: 4, pointBackgroundColor: '#f59e0b' },
];
if (budgetCrewLine.length > 0) {
  laborDatasets.push({ label: 'Bgt Crew Wages %', data: budgetCrewLine, borderColor: '#ef444488', borderDash: [6, 4], borderWidth: 2, pointRadius: 0, fill: false });
}
new Chart(document.getElementById('laborChart'), {
  type: 'line',
  data: {
    labels: labels,
    datasets: laborDatasets,
  },
  options: {
    responsive: true,
    plugins: { legend: { labels: { color: '#94a3b8' } } },
    scales: {
      x: { ticks: { color: '#64748b', font: { size: 10 } }, grid: { color: '#1e293b' } },
      y: { ticks: { color: '#64748b', callback: v => v + '%' }, grid: { color: '#1e293b44' }, suggestedMin: 15, suggestedMax: 45 }
    }
  }
});

// Store Scoreboard Table
const storeTable = document.getElementById('storeTable');
let tableHtml = `<thead><tr>
  <th>Store</th>
  <th class="right">Net Sales</th>
  <th class="right">Budget (pro)</th>
  <th class="right">vs Budget</th>
  <th class="right">Prior Year</th>
  <th class="right">SSS Growth</th>
  <th class="right">Labor %</th>
  <th class="right">Bgt Crew %</th>
  <th class="right">Guests</th>
  <th class="right">Avg Check</th>
</tr></thead><tbody>`;

D.store_order.forEach(num => {
  const s = D.stores[num];
  if (!s) return;
  const sssHtml = s.sss_growth != null ? fmtChange(s.sss_growth) : '<span class="neutral">N/A</span>';
  const budgetVarHtml = s.budget_variance != null ? fmtChange(s.budget_variance) : '<span class="neutral">—</span>';
  const laborCls = s.labor_pct > 35 ? 'negative' : s.labor_pct > 30 ? 'neutral' : 'positive';
  const bgtLaborCls = s.budget_crew_wages_pct > 0 ? (s.labor_pct > s.budget_crew_wages_pct + 2 ? 'negative' : s.labor_pct < s.budget_crew_wages_pct - 2 ? 'positive' : 'neutral') : 'neutral';
  tableHtml += `<tr>
    <td><strong>${num}</strong> ${s.name}</td>
    <td class="right">${fmt(s.net_sales)}</td>
    <td class="right" style="color:#94a3b8">${fmt(s.budget_sales_prorated)}</td>
    <td class="right">${budgetVarHtml}</td>
    <td class="right" style="color:#94a3b8">${fmt(s.py_net_sales)}</td>
    <td class="right">${sssHtml}</td>
    <td class="right"><span class="${laborCls}">${fmtPct(s.labor_pct)}</span></td>
    <td class="right" style="color:#94a3b8">${fmtPct(s.budget_crew_wages_pct)}</td>
    <td class="right">${s.guests.toLocaleString()}</td>
    <td class="right">${fmt(s.avg_check)}</td>
  </tr>`;
});

// Total row
const aBudgetVarHtml = a.budget_variance != null ? fmtChange(a.budget_variance) : '<span class="neutral">—</span>';
tableHtml += `<tr class="total-row">
  <td><strong>ALL STORES</strong></td>
  <td class="right">${fmt(a.net_sales)}</td>
  <td class="right" style="color:#94a3b8">${fmt(a.budget_sales_prorated)}</td>
  <td class="right">${aBudgetVarHtml}</td>
  <td class="right" style="color:#94a3b8">${fmt(a.py_net_sales)}</td>
  <td class="right">${a.sss_growth != null ? fmtChange(a.sss_growth) : '<span class="neutral">N/A</span>'}</td>
  <td class="right">${fmtPct(a.labor_pct)}</td>
  <td class="right" style="color:#94a3b8">${fmtPct(a.budget_crew_wages_pct)}</td>
  <td class="right">${a.guests.toLocaleString()}</td>
  <td class="right">${fmt(a.avg_check)}</td>
</tr>`;
tableHtml += '</tbody>';
storeTable.innerHTML = tableHtml;

// Daily Detail Tabs
const tabBar = document.getElementById('tabBar');
const tabContents = document.getElementById('tabContents');

// Add "All Stores" tab first
const allBtn = document.createElement('div');
allBtn.className = 'tab-btn active';
allBtn.textContent = 'All Stores';
allBtn.onclick = () => switchTab('all');
tabBar.appendChild(allBtn);

D.store_order.forEach(num => {
  const s = D.stores[num];
  if (!s) return;
  const btn = document.createElement('div');
  btn.className = 'tab-btn';
  btn.textContent = num + ' ' + s.name;
  btn.onclick = () => switchTab(num);
  tabBar.appendChild(btn);
});

function buildDailyTable(daily) {
  let html = `<table class="daily-table"><thead><tr>
    <th style="text-align:left">Date</th>
    <th>Net Sales</th>
    <th>Prior Year</th>
    <th>YoY Change</th>
    <th>Labor $</th>
    <th>Labor %</th>
    <th>Guests</th>
  </tr></thead><tbody>`;

  let totalNS = 0, totalPY = 0, totalLC = 0, totalGuests = 0;
  daily.forEach(d => {
    const dt = new Date(d.date + 'T12:00:00');
    const dayName = dayNames[dt.getDay()];
    const yoyPct = d.py_net_sales > 0 ? ((d.net_sales - d.py_net_sales) / d.py_net_sales * 100) : null;
    const laborCls = d.labor_pct > 35 ? 'negative' : d.labor_pct > 30 ? 'neutral' : 'positive';

    totalNS += d.net_sales;
    totalPY += d.py_net_sales;
    totalLC += d.labor_cost;
    totalGuests += d.guests || 0;

    html += `<tr>
      <td><span class="day-name">${dayName}</span> ${d.date}</td>
      <td>${fmt(d.net_sales)}</td>
      <td style="color:#64748b">${fmt(d.py_net_sales)}</td>
      <td>${yoyPct != null ? fmtChange(yoyPct) : '<span class="neutral">—</span>'}</td>
      <td>${fmt(d.labor_cost)}</td>
      <td><span class="${laborCls}">${fmtPct(d.labor_pct)}</span></td>
      <td>${(d.guests || 0).toLocaleString()}</td>
    </tr>`;
  });

  // Totals row
  const totalLaborPct = totalNS > 0 ? totalLC / totalNS * 100 : 0;
  const totalYoy = totalPY > 0 ? ((totalNS - totalPY) / totalPY * 100) : null;
  const totalLaborCls = totalLaborPct > 35 ? 'negative' : totalLaborPct > 30 ? 'neutral' : 'positive';
  html += `<tr style="background:#334155;font-weight:700">
    <td>TOTAL</td>
    <td>${fmt(totalNS)}</td>
    <td style="color:#64748b">${fmt(totalPY)}</td>
    <td>${totalYoy != null ? fmtChange(totalYoy) : '<span class="neutral">—</span>'}</td>
    <td>${fmt(totalLC)}</td>
    <td><span class="${totalLaborCls}">${fmtPct(totalLaborPct)}</span></td>
    <td>${totalGuests.toLocaleString()}</td>
  </tr>`;

  html += '</tbody></table>';
  return html;
}

// Build tab content for all stores
const allDiv = document.createElement('div');
allDiv.className = 'tab-content active';
allDiv.id = 'tab-all';
allDiv.innerHTML = buildDailyTable(a.daily || []);
tabContents.appendChild(allDiv);

D.store_order.forEach(num => {
  const s = D.stores[num];
  if (!s) return;
  const div = document.createElement('div');
  div.className = 'tab-content';
  div.id = 'tab-' + num;
  div.innerHTML = buildDailyTable(s.daily || []);
  tabContents.appendChild(div);
});

function switchTab(id) {
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById('tab-' + id).classList.add('active');
}
</script>
</body>
</html>